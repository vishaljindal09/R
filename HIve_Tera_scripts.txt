DROP TABLE IF EXISTS HP_MEMBER;

CREATE EXTERNAL TABLE IF NOT EXISTS optum.HP_MEMBER(
MBR_SYS_ID INT,
INDV_SYS_ID INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION '/data/optum/member';

DROP TABLE IF EXISTS ETG_SUMMARY;

CREATE EXTERNAL TABLE IF NOT EXISTS optum.ETG_SUMMARY(
ETG_FACT_SUMMARY_SYS_ID INT,
INDV_SYS_ID INT,
ETG_STRT_DT_SYS_ID INT,
STRT_DIAG_CD_SYS_ID INT,
SHFT_PROC_CD_SYS_ID INT,
SHFT_DIAG_CD_SYS_ID INT,
SVRTY_SCOR FLOAT,
CHRNC_ID INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION '/data/optum/etgsummary';

DROP TABLE IF EXISTS DIAGNOSIS_CODE;

CREATE EXTERNAL TABLE IF NOT EXISTS optum.DIAGNOSIS_CODE(
DIAG_CD_SYS_ID INT,
AHRQ_DIAG_DTL_CATGY_NM STRING,
AHRQ_DIAG_GENL_CATGY_CD INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION '/data/optum/diagnosiscode';

DROP TABLE IF EXISTS PHARMACY;

CREATE EXTERNAL TABLE IF NOT EXISTS optum.PHARMACY(
PHRM_FACT_SYS_ID INT,
MBR_SYS_ID INT,
GNRC_THRPTC_CLSS_CD_SYS_ID INT,
DIAG_CD_SYS_ID INT,
FILL_DT_SYS_ID INT,
DISPENSING_FEE_AMT FLOAT,
DED_AMT FLOAT,
DAY_SPL_CNT INT,
COPAY_AMT FLOAT,
ALLW_AMT FLOAT,
NDC_DRG_SYS_ID INT,
PD_AMT FLOAT,
CLI_DRG_CST_TIER_CD INT,
BRND_GNRC_CD STRING)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION '/data/optum/pharmacy';


DROP TABLE IF EXISTS GENERIC_THERAPEUTIC_CLASS;

CREATE EXTERNAL TABLE IF NOT EXISTS optum.GENERIC_THERAPEUTIC_CLASS(
GNRC_THRPTC_CLSS_CD_SYS_ID INT,
GNRC_THERAPEUTIC_CLSS_CD INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION '/data/optum/generictherapeuticclass';

DROP TABLE IF EXISTS NDC_DRUG;

CREATE EXTERNAL TABLE IF NOT EXISTS optum.NDC_DRUG(
NDC_DRG_SYS_ID INT,
GNRC_THERAPEUTIC_CLSS_CD INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION '/data/optum/ndcdrug';

DROP TABLE IF EXISTS PROCEDURE_CODE;


CREATE EXTERNAL TABLE IF NOT EXISTS optum.PROCEDURE_CODE(
SRVC_CATGY_DESC STRING,
PROC_CD_SYS_ID INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION '/data/optum/procedurecode';













